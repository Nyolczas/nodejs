// függőségek definiálása
var fs = require("fs")

// üzenet kiírása a konzolra
// @param message: string
var showConsoleMessage = function( message) {
    
    // Konzolra írás
    console.log(message);
};

// Adatok keresése.
// @param path: string, a file elérési útja.
// @param key: string, a változó kulcsa.
// @param: value: *, az érték.
// return: Array, a megfelelő rekordok
var findInJSON = function(path, key, value){
    value = value.toLowerCase();
    var jsonObject = readAsJSON(path);
    var records= [];
    for( var k in jsonObject) {
        // a keresett értéket alakítsa csupa kisbetűssé, és nézze meg hogy valahol szerepel-e benne a value - szórészletre is keres
        if(jsonObject[k][key].toLowerCase().indexOf(value) !== -1) { 
            records.push(jsonObject[k]);
        }
    }
    return records;
}

// JSON fájlok olvasása és objektummá alakítása
// @param path: string, a file elérési útja.
var readAsJSON = function(path) {
    
    // Json lekérése a file-rendszerből
    var json = fs.readFileSync( path, 'utf8');
    
    // Json string objektummá alakítása.
    json = JSON.parse(json);
    
    return json;
}

// Exportok (publikussá tétel)
module .exports = { 
    "showConsoleMessage": showConsoleMessage,     
    "find": findInJSON
};